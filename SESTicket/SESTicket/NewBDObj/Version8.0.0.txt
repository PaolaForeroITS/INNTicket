USE [SESTICKET]
GO

/****** Object:  Table [dbo].[TICKETSERVEVAL_ECP]    Script Date: 13/09/2019 11:14:33 a. m. ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TICKETSERVEVAL_ECP](
	[TICKETSERVEVALECPID] [nvarchar](255) NOT NULL,
	[TICKETID] [nvarchar](50) NOT NULL,
	[SERVICEDATE] [date] NOT NULL,
	[SERVDESCRIP] [nvarchar](max) NOT NULL,
	[EVAL_TIME1_1] [int] NOT NULL,
	[EVAL_TIME1_2] [int] NOT NULL,
	[EVAL_TIME1_3] [int] NOT NULL,
	[EVAL_TIME1_4] [int] NOT NULL,
	[EVAL_COST1_5] [int] NOT NULL,
	[EVAL_QUALITY1_6] [int] NOT NULL,
	[EVAL_QUALITY1_7] [int] NOT NULL,
	[EVAL_PS2_1] [int] NOT NULL,
	[EVAL_PS2_2] [int] NOT NULL,
	[EVAL_PS2_3] [int] NOT NULL,
	[EVAL_PS2_4] [int] NOT NULL,
	[OBS_C1] [nvarchar](max) NULL,
	[OBS_C2] [nvarchar](max) NULL,
	[ACTIVE] [nvarchar](3) NULL,
 CONSTRAINT [PK_TICKETSERVEVAL_ECP] PRIMARY KEY CLUSTERED 
(
	[TICKETSERVEVALECPID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO


----------------ACCESS DATABASE
Alter Table HSEQ_ANSWERS
Add column Evaluation Short Text, Question Number


----------------------------------------------
Create Table TICKETSERVEVAL_ECP




----------------------------------------------
Create Query TICKETSERVEVAL_ECP_V

SELECT TICKETSERVEVAL_ECP.TICKETSERVEVALECPID, TICKETSERVEVAL_ECP.TICKETID, TICKETSERVEVAL_ECP.SERVICEDATE, TICKETSERVEVAL_ECP.SERVDESCRIP, TICKETSERVEVAL_ECP.EVAL_TIME1_1, TICKETSERVEVAL_ECP.EVAL_TIME1_2, TICKETSERVEVAL_ECP.EVAL_TIME1_3, TICKETSERVEVAL_ECP.EVAL_TIME1_4, TICKETSERVEVAL_ECP.EVAL_COST1_5, TICKETSERVEVAL_ECP.EVAL_QUALITY1_6, TICKETSERVEVAL_ECP.EVAL_QUALITY1_7, TICKETSERVEVAL_ECP.EVAL_PS2_1, TICKETSERVEVAL_ECP.EVAL_PS2_2, TICKETSERVEVAL_ECP.EVAL_PS2_3, TICKETSERVEVAL_ECP.EVAL_PS2_4, TICKETSERVEVAL_ECP.OBS_C1, TICKETSERVEVAL_ECP.OBS_C2, TICKETSERVEVAL_ECP.ACTIVE, (SELECT H.DESCRIP FROM HSEQ_ANSWERS H WHERE H.ANSWERID = TICKETSERVEVAL_ECP.EVAL_TIME1_1 ) AS EVAL_TIME1_1_DESC, (SELECT H.DESCRIP FROM HSEQ_ANSWERS H WHERE H.ANSWERID = TICKETSERVEVAL_ECP.EVAL_TIME1_2 ) AS EVAL_TIME1_2_DESC, (SELECT H.DESCRIP FROM HSEQ_ANSWERS H WHERE H.ANSWERID = TICKETSERVEVAL_ECP.EVAL_TIME1_3 ) AS EVAL_TIME1_3_DESC, (SELECT H.DESCRIP FROM HSEQ_ANSWERS H WHERE H.ANSWERID = TICKETSERVEVAL_ECP.EVAL_TIME1_4 ) AS EVAL_TIME1_4_DESC, (SELECT H.DESCRIP FROM HSEQ_ANSWERS H WHERE H.ANSWERID = TICKETSERVEVAL_ECP.EVAL_COST1_5 ) AS EVAL_COST1_5_DESC, (SELECT H.DESCRIP FROM HSEQ_ANSWERS H WHERE H.ANSWERID = TICKETSERVEVAL_ECP.EVAL_QUALITY1_6 ) AS EVAL_QUALITY1_6_DESC, (SELECT H.DESCRIP FROM HSEQ_ANSWERS H WHERE H.ANSWERID = TICKETSERVEVAL_ECP.EVAL_QUALITY1_7 ) AS EVAL_QUALITY1_7_DESC, (SELECT H.DESCRIP FROM HSEQ_ANSWERS H WHERE H.ANSWERID = TICKETSERVEVAL_ECP.EVAL_PS2_1 ) AS EVAL_PS2_1_DESC, (SELECT H.DESCRIP FROM HSEQ_ANSWERS H WHERE H.ANSWERID = TICKETSERVEVAL_ECP.EVAL_PS2_2 ) AS EVAL_PS2_2_DESC, (SELECT H.DESCRIP FROM HSEQ_ANSWERS H WHERE H.ANSWERID = TICKETSERVEVAL_ECP.EVAL_PS2_3 ) AS EVAL_PS2_3_DESC, (SELECT H.DESCRIP FROM HSEQ_ANSWERS H WHERE H.ANSWERID = TICKETSERVEVAL_ECP.EVAL_PS2_4 ) AS EVAL_PS2_4_DESC
FROM TICKETSERVEVAL_ECP
ORDER BY TICKETSERVEVAL_ECP.SERVICEDATE;


-----------------------------------------------
Create Linked table zSQL_TICKETSERVEVAL_ECP