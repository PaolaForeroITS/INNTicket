CREATE TABLE RIG
(RIGID NVARCHAR(50) NOT NULL
);

alter table RIG
add constraint PK_RIGID
PRIMARY KEY(RIGID);

INSERT INTO RIG (RIGID) VALUES ('EI 1008');
INSERT INTO RIG (RIGID) VALUES ('EI 722');
INSERT INTO RIG (RIGID) VALUES ('NB 992');
INSERT INTO RIG (RIGID) VALUES ('IND 204');
INSERT INTO RIG (RIGID) VALUES ('NB PX 45');
INSERT INTO RIG (RIGID) VALUES ('NB PX 40');
INSERT INTO RIG (RIGID) VALUES ('RIGLESS');
INSERT INTO RIG (RIGID) VALUES ('NB PX 44');
INSERT INTO RIG (RIGID) VALUES ('NB 993');
INSERT INTO RIG (RIGID) VALUES ('IND 61');
INSERT INTO RIG (RIGID) VALUES ('EV 7');
INSERT INTO RIG (RIGID) VALUES ('PETROLAND');
INSERT INTO RIG (RIGID) VALUES ('PTW 157');
INSERT INTO RIG (RIGID) VALUES ('EI 707');
INSERT INTO RIG (RIGID) VALUES ('PTW 137');
INSERT INTO RIG (RIGID) VALUES ('EI 910');
INSERT INTO RIG (RIGID) VALUES ('PTW 118');
INSERT INTO RIG (RIGID) VALUES ('NB PX 38');
INSERT INTO RIG (RIGID) VALUES ('NB PX 42');
INSERT INTO RIG (RIGID) VALUES ('NB PX 43');
INSERT INTO RIG (RIGID) VALUES ('EI 1724');

ALTER TABLE WELL
ADD RIGID NVARCHAR(50) NULL;

UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 1008') WHERE WELLID='ACORDIONER';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 722') WHERE WELLID='AMBAR 55H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 722') WHERE WELLID='AMBAR 56H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB 992') WHERE WELLID='CA 216';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB 992') WHERE WELLID='CA 242 ST';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='IND 204') WHERE WELLID='CA 370';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 45') WHERE WELLID='CA 415|';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 45') WHERE WELLID='CA 416';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='CASE 0002H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='CASE 0003H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='CASE 0004H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='CASE 0005H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='CASE 0006H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='CASE 0007H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='CASE 0014H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='CASE 0016H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='CASE 0017H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='CASE 0018H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB 992') WHERE WELLID='CASTILLA 226';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB 992') WHERE WELLID='CASTILLA 242';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='IND 204') WHERE WELLID='CASTILLA 368';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='IND 204') WHERE WELLID='CASTILLA 369';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 45') WHERE WELLID='CASTILLA 511';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 45') WHERE WELLID='CASTILLA 512';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 45') WHERE WELLID='CASTILLA 513';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB 992') WHERE WELLID='Castilla 598';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB 992') WHERE WELLID='CASTILLA 600';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='RIGLESS') WHERE WELLID='CC SUR E1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='RIGLESS') WHERE WELLID='CC SUR E2';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='RIGLESS') WHERE WELLID='CC SUR E8';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='RIGLESS') WHERE WELLID='CC SUR SE8';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 44') WHERE WELLID='Chichimene 213';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB 993') WHERE WELLID='CHICHIMENE SW73';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB 993') WHERE WELLID='CHICHIMENESW75i';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 45') WHERE WELLID='CN 236';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 45') WHERE WELLID='CN 237';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='IND 61') WHERE WELLID='Copa 30H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='RIGLESS') WHERE WELLID='CRA 12';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB 992') WHERE WELLID='CRA 16';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='RIGLESS') WHERE WELLID='CUBARRO';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='RIGLESS') WHERE WELLID='JAGUAR 10A V1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='RIGLESS') WHERE WELLID='JAGUAR 23A';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 722') WHERE WELLID='JASPE 6D';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EV 7') WHERE WELLID='MANATUS 1 ST';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='IND 61') WHERE WELLID='Mauritia Nte 2 ';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='IND 61') WHERE WELLID='Mauritia Nte. 1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='IND 61') WHERE WELLID='Mauritia Nte. 4';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='IND 61') WHERE WELLID='Mauritia Nte. 5';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 722') WHERE WELLID='OPALO 25D';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 722') WHERE WELLID='OPALO 26H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 722') WHERE WELLID='OPALO 27H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 722') WHERE WELLID='OPALO 29H1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 722') WHERE WELLID='OPALO 4H1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PETROLAND') WHERE WELLID='QF 345H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PETROLAND') WHERE WELLID='QF 361H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 378H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 378H ST';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 511H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 515H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 535H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 541H ST';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 549H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 549H ST';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 550H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 552H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 557H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 558H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 559H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 560H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 561H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 562H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 563H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 722') WHERE WELLID='QF 564H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 565H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 566H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 568H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 569H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 570H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 571H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 572H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='RIGLESS') WHERE WELLID='QF 573';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 722') WHERE WELLID='QF 574V';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 137') WHERE WELLID='QF 575';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 576';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 578';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='RIGLESS') WHERE WELLID='QF 579';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 910') WHERE WELLID='QF 580V';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='RIGLESS') WHERE WELLID='QF 581';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 582H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 910') WHERE WELLID='QF 584';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 722') WHERE WELLID='QF 585D';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 910') WHERE WELLID='QF 586';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 587';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 137') WHERE WELLID='QF 588';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 590H ST';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 137') WHERE WELLID='QF 591H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 593H ST';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 595H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 597H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 118') WHERE WELLID='QF 599H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 601H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 137') WHERE WELLID='QF 602H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 137') WHERE WELLID='QF 603H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 910') WHERE WELLID='QF 604H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 118') WHERE WELLID='QF 607D';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QF 612H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 613H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 137') WHERE WELLID='QF 614H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 707') WHERE WELLID='QF 617H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 118') WHERE WELLID='QF 618H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 910') WHERE WELLID='QF 620H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 137') WHERE WELLID='QF 621H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QUIFA 587';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='PTW 157') WHERE WELLID='QUIFA 592H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1254H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1255H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1266H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1267H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1268H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1275H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1277H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1278H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1279 PILOTO';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1279H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1280H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1285H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1288H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1289H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1290H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1291H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1292H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1293H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1299H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1300H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1301H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1303H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1304H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1305H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1306H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1307H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1317 PILOTO';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1317H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1318H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1319H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1320H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1326 PILOTO';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1327H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1328H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1330 H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1331H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1333H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1333H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 43') WHERE WELLID='RB 1334H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 43') WHERE WELLID='RB 1335H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1342H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1349H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1350H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1352H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1353H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1359H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1360H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1361 PILOTO';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1361H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1366H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1367H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1368H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1369H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1370H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1374 PILOTO';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1374H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1375H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1376 H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1376 PILOTO';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1378H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1379H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1381H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1382H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1383H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1384H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1385H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1386H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1387 PILOTO';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1387H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1388 PILOTO';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1388H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1390H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1391H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1392 PILOTO';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1392H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1393H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1394H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1395H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1401H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1402H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1402H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1404H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 40') WHERE WELLID='RB 1405H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1406H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1407H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1408 PILOTO';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1408H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 43') WHERE WELLID='RB 1410H ST2';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 43') WHERE WELLID='RB 1411H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 43') WHERE WELLID='RB 1412H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 43') WHERE WELLID='RB 1413H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1419H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1420H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB 1421H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 43') WHERE WELLID='RB 1425H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1427H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1428 PILOTO';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1428H ST1';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB 1428H ST2';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB DW46H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB DW47H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB DW48H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 38') WHERE WELLID='RB DW49H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='NB PX 42') WHERE WELLID='RB1358H';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 1724') WHERE WELLID='Saimiri 4 ST';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 1724') WHERE WELLID='Saimiri 4 ST2';
UPDATE WELL SET RIGID=(SELECT RIGID FROM RIG WHERE RIGID='EI 1724') WHERE WELLID='Saimiri 4 ST3';


CREATE VIEW [dbo].[WELL_V] AS
SELECT well.WELLID
, well.NAME
, well.PETRFIELDID
, well.COUNTRY
, well.STATE
, well.CITY
, well.SITEID
, well.ACTIVE
, site.NAME AS SITENAME
, well.RIGID
FROM well
INNER JOIN site ON (well.SITEID = site.SITEID) ;

CREATE VIEW [dbo].[RIG_V] AS
SELECT RIGID FROM RIG UNION ALL
SELECT '';

INSERT INTO [dbo].[VERSIONBASETABLE] VALUES ('RIG',GETDATE(),14);


ALTER VIEW [dbo].[TICKETHEADERRPT_V] AS
WITH TICKETAMOUNT (
TICKETID, 
ITEMAMOUNTNODISC_COP, DISCVALUE_COP, ITEMAMOUNT_COP,
ITEMAMOUNTNODISC_USD, DISCVALUE_USD, ITEMAMOUNT_USD) AS
(
SELECT 
 TS.TICKETID
,sum(TS.ITEMAMOUNTNODISC   ) AS ITEMAMOUNTNODISC_COP
,sum(TS.DISCVALUE          ) AS DISCVALUE_COP
,sum(TS.ITEMAMOUNT         ) AS ITEMAMOUNT_COP
,sum(TS.ITEMAMOUNTNODISCUSD) AS ITEMAMOUNTNODISC_USD
,sum(TS.DISCVALUEUSD       ) AS DISCVALUE_USD
,sum(TS.ITEMAMOUNTUSD      ) AS ITEMAMOUNT_USD
FROM TICKETSALESITEM TS
GROUP BY TS.TICKETID
)
SELECT 
 T.TICKETID
,T.DATESERVICE
,(SELECT U.NAME FROM [USER] U WHERE U.USERNAME = T.CREATEDUSER) AS CREATEDUSER
,T.CREATEDDATETIME
,T.CUSTOMERID AS CUSTOMERCODE
,C.NAME AS CUSTOMERNAME
,CT.CONTRACTNUMBER AS CONTRACT
,ST.DESCRIPTION AS SERVICETYPE
,T.WELLID
,W.RIGID AS RIG
,T.EXCHANGERATE
,T.CURRENCYID
,CASE T.CURRENCYID WHEN 'USD' THEN TA.ITEMAMOUNTNODISC_USD ELSE TA.ITEMAMOUNTNODISC_COP END AS ITEMAMOUNTNODISC
,CASE T.CURRENCYID WHEN 'USD' THEN TA.DISCVALUE_USD ELSE TA.DISCVALUE_COP END AS DISCVALUE
,CASE T.CURRENCYID WHEN 'USD' THEN TA.ITEMAMOUNT_USD ELSE TA.ITEMAMOUNT_COP END AS ITEMAMOUNT
,T.TIMEARRIVED
,T.TIMESTARTED
,T.TIMECOMPLETED
,T.CASINGSIZE
,T.CASINGWEIGHT
,T.CASINGGRADE
,T.TUBINGSIZE
,T.TUBINGWEIGHT
,T.TUBINGGRADE
,T.PRESSUREMAX
,T.DEPTHMAX
,T.JOBDESCRIPTION
,T.CUSTREPRES
,T.CUSTREPRESPOSITION
,T.CUSTREPRESASSIST
,(CONTREP.[NAME1] + ' ' +
CASE WHEN CONTREP.[NAME2] IS NULL OR CONTREP.[NAME2]='' THEN '' ELSE LEFT(CONTREP.[NAME2],1) + '. ' END +
CASE WHEN CONTREP.[SURNAME1] IS NULL OR CONTREP.[NAME2]='' THEN '' ELSE LEFT(CONTREP.[SURNAME1],1) + '. ' END +
CONTREP.[SURNAME2]) AS CONTRACTORREPRESENTATIVE
,T.CUSTCOMMENTS
,T.CONTRACTCOMMENTS
,T.TICKETSTATUS
,T.UPDATEDDATETIME
,(SELECT U.NAME FROM [USER] U WHERE U.USERNAME = T.UPDATEDUSER) AS UPDATEDUSER
,T.CANCELDATETIME
,(SELECT U.NAME FROM [USER] U WHERE U.USERNAME = T.CANCELUSER) AS CANCELUSER
,T.CANCELREASON
,STUFF((SELECT ' / ' + INV.LINETYPE + ': ' + INVOICESTATUS AS "text()" 
		FROM  TICKETINVOICE INV
		WHERE INV.TICKETID = T.TICKETID
     FOR XML PATH('')),1,3, '') AS INVOICESTATUS
,STUFF((SELECT ' / ' + 'Invoice: ' + ISNULL(LINE.INVOICENUMBER,'') + ' Amount: ' + CAST(LINE.INVOICEAMOUNT AS VARCHAR) 
		+ ' (' + INV.LINETYPE + ')' AS "text()" 
		FROM  TICKETINVOICE INV
		INNER JOIN TICKETINVOICELINE LINE ON (INV.TICKETINVOICEID = LINE.TICKETINVOICEID)
		WHERE INV.TICKETID = T.TICKETID AND LINE.ACTIVE = 'YES'
     FOR XML PATH('')),1,3, '') AS INVOICENNUMBER
,(SELECT  SUM(LINE.INVOICEAMOUNT) 
		FROM  TICKETINVOICE INV
		INNER JOIN TICKETINVOICELINE LINE ON (INV.TICKETINVOICEID = LINE.TICKETINVOICEID)
		WHERE INV.TICKETID = T.TICKETID AND LINE.ACTIVE = 'YES') AS INVOICEAMOUNT
FROM TICKET T  
   INNER JOIN CUSTOMER C  ON (T.CUSTOMERID = C.CUSTOMERID)
   INNER JOIN CONTRACT CT ON (T.CONTRACTID = CT.CONTRACTID)
   INNER JOIN SERVICETYPE ST ON (T.SERVICETYPEID = ST.SERVICETYPEID)
   INNER JOIN WORKER CONTREP ON (T.CONTRACTORREPRESENTATIVE = CONTREP.WORKERID)
   INNER JOIN WELL W ON (T.WELLID = W.WELLID)
   LEFT JOIN TICKETAMOUNT TA ON (TA.TICKETID = T.TICKETID)
   
   
GO


ALTER  PROCEDURE [dbo].[sp_TicketHeaderRpt]
    @ServiceDateBegin   datetime     = null
   ,@ServiceDateEnd     datetime     = null
   ,@TicketId	     varchar(50)  = null
   ,@CreatedBy		 varchar(max)  = null
   ,@TicketStatus    varchar(max) = null
AS
BEGIN
 
    ----------------------
    -- Tratando Parametros
    ----------------------
    set @ServiceDateBegin = cast(floor(cast(@ServiceDateBegin as float)) as datetime);
    set @ServiceDateEnd = cast(floor(cast(@ServiceDateEnd as float)) as datetime);
    set @TicketId = UPPER(replace(@TicketId,'*','%'));

	----------------------
    -- Execução
    ----------------------
    SELECT *
  FROM TICKETHEADERRPT_V
  where
		1 = 1
	and cast(floor(cast(DATESERVICE as float)) as datetime)  between @ServiceDateBegin and @ServiceDateEnd
	and (TICKETID = @TicketId or (@TicketId = '' or @TicketId is null) or TICKETID like @TicketId)
	and (CREATEDUSER in (select * from dbo.fnStringMultValues (@CreatedBy)) OR @CreatedBy is null or @CreatedBy='')
	and (TICKETSTATUS in (select * from dbo.fnStringMultValues (@TicketStatus)) OR @TicketStatus is null or @TicketStatus=''  )
	order by TICKETID asc

END


GO


