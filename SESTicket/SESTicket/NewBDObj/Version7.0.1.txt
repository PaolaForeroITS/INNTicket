ALTER TABLE TICKET
ADD [CLOSEDUSER] [nvarchar](30) NULL,
[CLOSEDDATE] [date] NULL;

UPDATE TICKET SET
CLOSEDDATE = DATESERVICE 
,CLOSEDUSER=CREATEDUSER
WHERE
TICKETSTATUS = 'Closed';


ALTER view [dbo].[INVOICE_TICKET_TOTAL_V] AS
SELECT 
 [TICKET].TICKETID
,[TICKET].SUPERIORNUM AS SERVICETICKET
,[TICKET].DATESERVICE
,U.NAME AS CREATEDBY
,[TICKET].TICKETSTATUS 
,[TICKET].SERVICETYPEGRPCODE 
,[TICKET].SERVICETYPEGRPTEXT AS SERVICETYPE
,[TICKET].JOBDESCRIPTION 
,[SERVICELINE].NAME AS SERVICELINE
,[CUSTOMER].NAME AS CUSTOMER
,[CONTRACT].CONTRACTNUMBER 
,[SITE].ALIAS AS SITE
,[TICKET].WELLID 
,'Serv/Mat' as LINETYPE
,[CONTRACT].CURRENCY 
,isnull((SELECT ST.AMOUNTUSD FROM [SALESITEM_TOTAL_L01_V] ST WHERE ST.TICKETID = [TICKET].TICKETID AND LINETYPE = 'SubTotal'),0) AS SUBTOTAL
, 0 AS DISCOUNT
,isnull((SELECT ST.AMOUNTUSD FROM [SALESITEM_TOTAL_L01_V] ST WHERE ST.TICKETID = [TICKET].TICKETID AND LINETYPE = 'SubTotal'),0) AS TICKETTOTAL
,[TICKETINVOICE].TICKETINVOICEID
,ISNULL([TICKETINVOICE].INVOICESTATUS,'No Invoiced') as INVOICESTATUS
,[TICKET].SERVICELINEID
,[CONTRACT].CUSTOMERID
,[TICKET].SITEID
,[TICKET].CLOSEDDATE
,[TICKET].DM
,[TICKET].JOBNUMBER
,[TICKET].SERVICEORDERNUM
FROM [TICKET] 
INNER JOIN [CONTRACT] ON ([TICKET].CONTRACTID = [CONTRACT].CONTRACTID)
INNER JOIN [CUSTOMER] ON ([CONTRACT].CUSTOMERID = [CUSTOMER].CUSTOMERID)
INNER JOIN [USER] U   ON ([TICKET].CREATEDUSER = U.USERNAME)
INNER JOIN [SERVICELINE] ON ([TICKET].SERVICELINEID = [SERVICELINE].SERVICELINEID)
INNER JOIN [WELL] ON ([TICKET].WELLID = [WELL].WELLID)
INNER JOIN [SITE] ON ([TICKET].SITEID = [SITE].SITEID)
LEFT JOIN  [TICKETINVOICE] ON ([TICKET].TICKETID = [TICKETINVOICE].TICKETID AND [TICKETINVOICE].LINETYPE = 'Serv/Mat')
WHERE [CONTRACT].LAYOUTTYPE  = 'L01' 
union all
SELECT 
 [TICKET].TICKETID
,[TICKET].SUPERIORNUM AS SERVICETICKET
,[TICKET].DATESERVICE
,U.NAME AS CREATEDBY
,[TICKET].TICKETSTATUS 
,[TICKET].SERVICETYPEGRPCODE
,[TICKET].SERVICETYPEGRPTEXT AS SERVICETYPE
,[TICKET].JOBDESCRIPTION 
,[SERVICELINE].NAME AS SERVICELINE
,[CUSTOMER].NAME AS CUSTOMER
,[CONTRACT].CONTRACTNUMBER 
,[SITE].ALIAS AS SITE
,[TICKET].WELLID 
,'Material' as LINETYPE
,[CONTRACT].CURRENCY
,isnull((SELECT IIF([CONTRACT].CURRENCY = 'USD',ST.AMOUNTUSD,ST.AMOUNT) FROM [SALESITEM_TOTAL_L02_MAT_V] ST WHERE ST.TICKETID = [TICKET].TICKETID AND LINETYPE = 'SubTotal'),0) AS SUBTOTAL
,isnull((SELECT IIF([CONTRACT].CURRENCY = 'USD',ST.AMOUNTUSD,ST.AMOUNT) FROM [SALESITEM_TOTAL_L02_MAT_V] ST WHERE ST.TICKETID = [TICKET].TICKETID AND LINETYPE = 'Discount'),0) AS DISCOUNT
,isnull((SELECT IIF([CONTRACT].CURRENCY = 'USD',ST.AMOUNTUSD,ST.AMOUNT) FROM [SALESITEM_TOTAL_L02_MAT_V] ST WHERE ST.TICKETID = [TICKET].TICKETID AND LINETYPE = 'SubTotal') 
-(SELECT IIF([CONTRACT].CURRENCY = 'USD',ST.AMOUNTUSD,ST.AMOUNT) FROM [SALESITEM_TOTAL_L02_MAT_V] ST WHERE ST.TICKETID = [TICKET].TICKETID AND LINETYPE = 'Discount'),0) AS TICKETTOTAL
,[TICKETINVOICE].TICKETINVOICEID
,ISNULL([TICKETINVOICE].INVOICESTATUS,'No Invoiced') as INVOICESTATUS
,[TICKET].SERVICELINEID
,[CONTRACT].CUSTOMERID
,[TICKET].SITEID
,[TICKET].CLOSEDDATE
,[TICKET].DM
,[TICKET].JOBNUMBER
,[TICKET].SERVICEORDERNUM
FROM [TICKET] 
INNER JOIN [CONTRACT] ON ([TICKET].CONTRACTID = [CONTRACT].CONTRACTID)
INNER JOIN [CUSTOMER] ON ([CONTRACT].CUSTOMERID = [CUSTOMER].CUSTOMERID)
INNER JOIN [USER] U   ON ([TICKET].CREATEDUSER = U.USERNAME)
INNER JOIN [SERVICELINE] ON ([TICKET].SERVICELINEID = [SERVICELINE].SERVICELINEID)
INNER JOIN [WELL] ON ([TICKET].WELLID = [WELL].WELLID)
INNER JOIN [SITE] ON ([TICKET].SITEID = [SITE].SITEID)
LEFT JOIN  [TICKETINVOICE] ON ([TICKET].TICKETID = [TICKETINVOICE].TICKETID AND [TICKETINVOICE].LINETYPE = 'Material')
WHERE [CONTRACT].LAYOUTTYPE  = 'L02'  and [CONTRACT].SPLITAMOUNTMATSERV = 'YES'
AND EXISTS (SELECT 1 FROM [SALESITEM_TOTAL_L02_MAT_V] WHERE [SALESITEM_TOTAL_L02_MAT_V].TICKETID = [TICKET].TICKETID)
union all
SELECT 
 [TICKET].TICKETID
,[TICKET].SUPERIORNUM AS SERVICETICKET
,[TICKET].DATESERVICE
,U.NAME AS CREATEDBY
,[TICKET].TICKETSTATUS 
,[TICKET].SERVICETYPEGRPCODE
,[TICKET].SERVICETYPEGRPTEXT AS SERVICETYPE
,[TICKET].JOBDESCRIPTION 
,[SERVICELINE].NAME AS SERVICELINE
,[CUSTOMER].NAME AS CUSTOMER
,[CONTRACT].CONTRACTNUMBER 
,[SITE].ALIAS AS SITE
,[TICKET].WELLID 
,'Service' as LINETYPE
,[CONTRACT].CURRENCY 
,isnull((SELECT IIF([CONTRACT].CURRENCY = 'USD',ST.AMOUNTUSD,ST.AMOUNT) FROM [SALESITEM_TOTAL_L02_SERV_V] ST WHERE ST.TICKETID = [TICKET].TICKETID AND LINETYPE = 'SubTotal'),0) AS SUBTOTAL
,isnull((SELECT IIF([CONTRACT].CURRENCY = 'USD',ST.AMOUNTUSD,ST.AMOUNT) FROM [SALESITEM_TOTAL_L02_SERV_V] ST WHERE ST.TICKETID = [TICKET].TICKETID AND LINETYPE = 'Discount'),0) AS DISCOUNT
,isnull((SELECT IIF([CONTRACT].CURRENCY = 'USD',ST.AMOUNTUSD,ST.AMOUNT) FROM [SALESITEM_TOTAL_L02_SERV_V] ST WHERE ST.TICKETID = [TICKET].TICKETID AND LINETYPE = 'SubTotal') 
-(SELECT IIF([CONTRACT].CURRENCY = 'USD',ST.AMOUNTUSD,ST.AMOUNT) FROM [SALESITEM_TOTAL_L02_SERV_V] ST WHERE ST.TICKETID = [TICKET].TICKETID AND LINETYPE = 'Discount'),0) AS TICKETTOTAL
,[TICKETINVOICE].TICKETINVOICEID
,ISNULL([TICKETINVOICE].INVOICESTATUS,'No Invoiced') as INVOICESTATUS
,[TICKET].SERVICELINEID
,[CONTRACT].CUSTOMERID
,[TICKET].SITEID
,[TICKET].CLOSEDDATE
,[TICKET].DM
,[TICKET].JOBNUMBER
,[TICKET].SERVICEORDERNUM
FROM [TICKET] 
INNER JOIN [CONTRACT] ON ([TICKET].CONTRACTID = [CONTRACT].CONTRACTID)
INNER JOIN [CUSTOMER] ON ([CONTRACT].CUSTOMERID = [CUSTOMER].CUSTOMERID)
INNER JOIN [USER] U   ON ([TICKET].CREATEDUSER = U.USERNAME)
INNER JOIN [SERVICELINE] ON ([TICKET].SERVICELINEID = [SERVICELINE].SERVICELINEID)
INNER JOIN [WELL] ON ([TICKET].WELLID = [WELL].WELLID)
INNER JOIN [SITE] ON ([TICKET].SITEID = [SITE].SITEID)
LEFT JOIN  [TICKETINVOICE] ON ([TICKET].TICKETID = [TICKETINVOICE].TICKETID AND [TICKETINVOICE].LINETYPE = 'Service')
WHERE [CONTRACT].LAYOUTTYPE  = 'L02' and [CONTRACT].SPLITAMOUNTMATSERV = 'YES'
AND EXISTS (SELECT 1 FROM [SALESITEM_TOTAL_L02_SERV_V] WHERE [SALESITEM_TOTAL_L02_SERV_V].TICKETID = [TICKET].TICKETID)
union all
SELECT 
 [TICKET].TICKETID
,[TICKET].SUPERIORNUM AS SERVICETICKET
,[TICKET].DATESERVICE
,U.NAME AS CREATEDBY
,[TICKET].TICKETSTATUS 
,[TICKET].SERVICETYPEGRPCODE
,[TICKET].SERVICETYPEGRPTEXT AS SERVICETYPE
,[TICKET].JOBDESCRIPTION 
,[SERVICELINE].NAME AS SERVICELINE
,[CUSTOMER].NAME AS CUSTOMER
,[CONTRACT].CONTRACTNUMBER 
,[SITE].ALIAS AS SITE
,[TICKET].WELLID 
,'Serv/Mat' as LINETYPE
,[CONTRACT].CURRENCY 
,isnull((SELECT IIF([CONTRACT].CURRENCY = 'USD',ST.AMOUNTUSD,ST.AMOUNT) FROM [SALESITEM_TOTAL_L02_V] ST WHERE ST.TICKETID = [TICKET].TICKETID AND LINETYPE = 'SubTotal'),0) AS SUBTOTAL
,isnull((SELECT IIF([CONTRACT].CURRENCY = 'USD',ST.AMOUNTUSD,ST.AMOUNT) FROM [SALESITEM_TOTAL_L02_V] ST WHERE ST.TICKETID = [TICKET].TICKETID AND LINETYPE = 'Discount'),0) AS DISCOUNT
,isnull((SELECT IIF([CONTRACT].CURRENCY = 'USD',ST.AMOUNTUSD,ST.AMOUNT) FROM [SALESITEM_TOTAL_L02_V] ST WHERE ST.TICKETID = [TICKET].TICKETID AND LINETYPE = 'SubTotal') 
-(SELECT IIF([CONTRACT].CURRENCY = 'USD',ST.AMOUNTUSD,ST.AMOUNT) FROM [SALESITEM_TOTAL_L02_V] ST WHERE ST.TICKETID = [TICKET].TICKETID AND LINETYPE = 'Discount'),0) AS TICKETTOTAL
,[TICKETINVOICE].TICKETINVOICEID
,ISNULL([TICKETINVOICE].INVOICESTATUS,'No Invoiced') as INVOICESTATUS
,[TICKET].SERVICELINEID
,[CONTRACT].CUSTOMERID
,[TICKET].SITEID
,[TICKET].CLOSEDDATE
,[TICKET].DM
,[TICKET].JOBNUMBER
,[TICKET].SERVICEORDERNUM
FROM [TICKET] 
INNER JOIN [CONTRACT] ON ([TICKET].CONTRACTID = [CONTRACT].CONTRACTID)
INNER JOIN [CUSTOMER] ON ([CONTRACT].CUSTOMERID = [CUSTOMER].CUSTOMERID)
INNER JOIN [USER] U   ON ([TICKET].CREATEDUSER = U.USERNAME)
INNER JOIN [SERVICELINE] ON ([TICKET].SERVICELINEID = [SERVICELINE].SERVICELINEID)
INNER JOIN [WELL] ON ([TICKET].WELLID = [WELL].WELLID)
INNER JOIN [SITE] ON ([TICKET].SITEID = [SITE].SITEID)
LEFT JOIN  [TICKETINVOICE] ON ([TICKET].TICKETID = [TICKETINVOICE].TICKETID AND [TICKETINVOICE].LINETYPE = 'Serv/Mat')
WHERE [CONTRACT].LAYOUTTYPE  = 'L02' and [CONTRACT].SPLITAMOUNTMATSERV = 'NO'
AND EXISTS (SELECT 1 FROM [SALESITEM_TOTAL_L02_V] WHERE [SALESITEM_TOTAL_L02_V].TICKETID = [TICKET].TICKETID)


GO


ALTER VIEW [dbo].[INVOICE_V] AS
SELECT 
 I.[TICKETID]
,I.[SERVICETICKET]
,I.[DATESERVICE]
,STUFF((SELECT char(10) 
     + IIF(ID.INVOICEDATE IS NOT NULL, CONVERT(VARCHAR,ID.INVOICEDATE,103),' ')
	  AS "text()" 
     FROM TICKETINVOICELINE ID
     WHERE ID.ACTIVE = 'YES'
	 AND ID.TICKETID = I.TICKETID
     FOR XML PATH('')),1,1, '') AS INVOICEDATE
,STUFF((SELECT char(10) 
	 + 'Invoice: ' + IIF(ID.INVOICENUMBER IS NOT NULL, ID.INVOICENUMBER,' ')
     + ' Date: ' + IIF(ID.INVOICEDATE IS NOT NULL, CONVERT(VARCHAR,ID.INVOICEDATE,103),' ')
	 + ' Amount: ' + IIF(ID.INVOICEAMOUNT IS NOT NULL, CAST(ID.INVOICEAMOUNT AS VARCHAR),' ')
	  AS "text()" 
     FROM TICKETINVOICELINE ID
     WHERE ID.ACTIVE = 'YES'
	 AND ID.TICKETID = I.TICKETID
     FOR XML PATH('')),1,1, '') AS INVOICEDETAIL
,I.[CREATEDBY]
,I.[TICKETSTATUS]
,I.[SERVICELINE]
,I.[CUSTOMER]
,I.[CONTRACTNUMBER]
,I.[SITE]
,I.[WELLID]
,I.[LINETYPE]
,I.SERVICETYPEGRPCODE 
,I.SERVICETYPE
,I.[CURRENCY]
,I.[SUBTOTAL]
,I.[DISCOUNT]
,I.[TICKETTOTAL]
,I.[TICKETINVOICEID]
,I.[INVOICESTATUS]
,I.SERVICELINEID
,I.CUSTOMERID
,I.SITEID
,ISNULL((SELECT SUM(LN.INVOICEAMOUNT) FROM [TICKETINVOICELINE] LN 
WHERE LN.TICKETINVOICEID = I.TICKETINVOICEID AND [ACTIVE] = 'YES'),0) AS INVOICETOTAL
,(ISNULL((SELECT SUM(LN.INVOICEAMOUNT) FROM [TICKETINVOICELINE] LN 
WHERE LN.TICKETINVOICEID = I.TICKETINVOICEID AND [ACTIVE] = 'YES'),0) - I.[TICKETTOTAL]) 
 AS DIF
,I.CLOSEDDATE
,I.DM
,I.JOBNUMBER
,I.SERVICEORDERNUM
FROM [INVOICE_TICKET_TOTAL_V]  I


GO




ALTER  PROCEDURE [dbo].[sp_TicketInvoice]
    @DateType	        varchar(50)  = 'Service Date'
   ,@DateBegin          datetime     = null
   ,@DateEnd            datetime     = null

   ,@TicketId	        varchar(max)  = null
   ,@ServiceTicket	    varchar(max) = null
   ,@TicketStatus       varchar(max) = null
   ,@InvoiceStatus      varchar(max) = null
   ,@InvoiceNumber      varchar(max) = null

   ,@ServiceLineId      varchar(max) = null
   ,@CustomerId         varchar(max) = null
   ,@SiteId             varchar(max) = null

 
AS
DECLARE @TmpTicketList TABLE (TICKETID NVARCHAR(50))

BEGIN
 
    ----------------------
    -- Tratando Parametros
    ----------------------
    set @DateBegin = cast(floor(cast(@DateBegin as float)) as datetime);
    set @DateEnd = cast(floor(cast(@DateEnd as float)) as datetime);
    
	if @TicketId is not null or @TicketId <> '' begin
	    set @TicketId = '%' + @TicketId + '%'
	end 
	else begin
	    set @TicketId = null
	end;

	if @InvoiceNumber is  null or @InvoiceNumber = '' 
	    set @InvoiceNumber = null;

	
	if @ServiceTicket is null or ISNULL(@ServiceTicket,'-1') = '-1' or  @ServiceTicket = ''
	    set @ServiceTicket = NULL;
	else 
	    set @ServiceTicket = '%' + @ServiceTicket + '%';


	if @ServiceLineId is  null or @ServiceLineId = '' begin
	    set @ServiceLineId = '-1'
	end;

	if @CustomerId is  null or @CustomerId = '' begin
	    set @CustomerId = '-1'
	end;

	if @SiteId is  null or @SiteId = '' begin
	    set @SiteId = '-1'
	end;

	if @TicketStatus is null or @TicketStatus = '-1' or @TicketStatus = 'All' begin
	    set @TicketStatus = 'Open,Closed'
	end;
		

	----------------------
    -- Execução
    ----------------------
	IF  @DateType = 'Service Date' 
		insert into @TmpTicketList (TICKETID)
		select DISTINCT T.TICKETID 
		from TICKET T
		left join TICKETINVOICELINE IL ON (T.TICKETID = IL.TICKETID and (IL.ACTIVE = 'YES'))
		where
		1 = 1
		and cast(floor(cast(T.DATESERVICE as float)) as datetime)  between @DateBegin and @DateEnd
		and (T.TICKETSTATUS in (select * from dbo.fnStringMultValues (@TicketStatus)) )
		and (T.TICKETID = @TicketId or @TicketId is null or T.TICKETID like @TicketId)
		and (T.SUPERIORNUM = @ServiceTicket or (@ServiceTicket is null and LEN(IIF(T.SUPERIORNUM IS NULL,'',T.SUPERIORNUM))=0) 
	    or T.SUPERIORNUM like @ServiceTicket or @ServiceTicket is null)
		and (T.TICKETSTATUS in (select * from dbo.fnStringMultValues (@TicketStatus)) )
			and (T.SERVICELINEID = iif(@ServiceLineId = '-1',T.SERVICELINEID,@ServiceLineId))
		and (T.CUSTOMERID = iif(@CustomerId = '-1',T.CUSTOMERID,@CustomerId))
		and (T.SITEID = iif(@SiteId = '-1',T.SITEID,@SiteId))
		and (IL.INVOICENUMBER = @InvoiceNumber or @InvoiceNumber is null )
		;
		
	else if  @DateType = 'Invoice Date' 
	
		insert into @TmpTicketList (TICKETID)
		select DISTINCT T.TICKETID 
		from TICKET T
		left join TICKETINVOICELINE IL ON (T.TICKETID = IL.TICKETID and (IL.ACTIVE = 'YES') )
		where
		1 = 1
		and (IL.INVOICEDATE between cast(@DateBegin as date) and cast(@DateEnd as date))
		and (T.TICKETSTATUS in (select * from dbo.fnStringMultValues (@TicketStatus)) )
		and (T.TICKETID = @TicketId or @TicketId is null or T.TICKETID like @TicketId)
		and (T.SUPERIORNUM = @ServiceTicket or (@ServiceTicket is null and LEN(IIF(T.SUPERIORNUM IS NULL,'',T.SUPERIORNUM))=0) 
	    or T.SUPERIORNUM like @ServiceTicket or @ServiceTicket is null)
		and (T.TICKETSTATUS in (select * from dbo.fnStringMultValues (@TicketStatus)) )
			and (T.SERVICELINEID = iif(@ServiceLineId = '-1',T.SERVICELINEID,@ServiceLineId))
		and (T.CUSTOMERID = iif(@CustomerId = '-1',T.CUSTOMERID,@CustomerId))
		and (T.SITEID = iif(@SiteId = '-1',T.SITEID,@SiteId))
		and (IL.INVOICENUMBER = @InvoiceNumber or @InvoiceNumber is null )
		;
	
	else
		insert into @TmpTicketList (TICKETID)
		select DISTINCT T.TICKETID 
		from TICKET T
		left join TICKETINVOICELINE IL ON (T.TICKETID = IL.TICKETID and (IL.ACTIVE = 'YES') )
		where
		1 = 1
		and (T.CLOSEDDATE between cast(@DateBegin as date) and cast(@DateEnd as date))
		and (T.TICKETSTATUS in (select * from dbo.fnStringMultValues (@TicketStatus)) )
		and (T.TICKETID = @TicketId or @TicketId is null or T.TICKETID like @TicketId)
		and (T.SUPERIORNUM = @ServiceTicket or (@ServiceTicket is null and LEN(IIF(T.SUPERIORNUM IS NULL,'',T.SUPERIORNUM))=0) 
	    or T.SUPERIORNUM like @ServiceTicket or @ServiceTicket is null)
		and (T.TICKETSTATUS in (select * from dbo.fnStringMultValues (@TicketStatus)) )
			and (T.SERVICELINEID = iif(@ServiceLineId = '-1',T.SERVICELINEID,@ServiceLineId))
		and (T.CUSTOMERID = iif(@CustomerId = '-1',T.CUSTOMERID,@CustomerId))
		and (T.SITEID = iif(@SiteId = '-1',T.SITEID,@SiteId))
		and (IL.INVOICENUMBER = @InvoiceNumber or @InvoiceNumber is null )
		;

	----------------------
    -- Query Final
    ----------------------
	SELECT 
	 I.[TICKETID]
	,I.[SERVICETICKET]
	,I.[DATESERVICE]
	,I.[INVOICEDATE]
	,I.[INVOICEDETAIL]
	,I.[CREATEDBY]
	,I.[TICKETSTATUS]
	,I.[SERVICELINE]
	,I.[CUSTOMER]
	,I.[CONTRACTNUMBER]
	,I.[SITE]
	,I.[WELLID]
	,I.[LINETYPE]
	,I.SERVICETYPEGRPCODE 
	,I.SERVICETYPE
	,I.[CURRENCY]
	,I.[SUBTOTAL]
	,I.[DISCOUNT]
	,I.[TICKETTOTAL]
	,I.[TICKETINVOICEID]
	,I.[INVOICESTATUS]
	,I.[SERVICELINEID]
	,I.[CUSTOMERID]
	,I.[SITEID]
	,I.[INVOICETOTAL]
	,I.[DIF]
	,I.CLOSEDDATE
	,I.DM
	,I.JOBNUMBER
	,I.SERVICEORDERNUM
	FROM [INVOICE_V] I 
	INNER JOIN @TmpTicketList TMP ON (I.TICKETID = TMP.TICKETID)
	WHERE
	1 =1
	and (I.INVOICESTATUS in (select * from dbo.fnStringMultValues (@InvoiceStatus)) OR @InvoiceStatus IS NULL)
	order by  I.[DATESERVICE] asc;

END


GO




INSERT INTO OBJECTGROUPITEM
VALUES (54,1,'frmInvoiceList','bPermitChangeTicketClosedDate','VAR','Permit Change Ticket Closed Date','NO');

INSERT INTO [OBJECTGROUPITEMUSER] (USERNAME,OBJECTGROUPITEMID,[ENABLE])
SELECT USERNAME,54,'NO'
FROM [USER];

--MUDAR A DATA DE SYNCRONIZACAO!!!!